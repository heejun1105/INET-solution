########################################
# INET Railway 운영 환경 설정
# 
# Railway 배포 시 자동으로 사용됩니다.
# SPRING_PROFILES_ACTIVE=prod 환경 변수를 설정하면 이 파일이 적용됩니다.
########################################

########################################
# 서버 포트 (Railway 환경 변수 사용)
########################################
# Railway는 자동으로 PORT 환경 변수를 제공합니다.
server.port=${PORT:8082}
server.address=0.0.0.0

########################################
# 데이터베이스 연결 (Railway 환경 변수 사용 - 단순 버전)
########################################
# Web Service 쪽 Variables에서 아래 값을 설정하면 됩니다:
# - MYSQL_URL          (MySQL 서비스의 MYSQL_URL과 동일하게)
# - MYSQLUSER          (보통 root)
# - MYSQL_ROOT_PASSWORD(비밀번호)
#
# MySQL 서비스의 Variables → Raw Editor에 있는 내용을
# Web Service(INET-solution)의 Variables → Raw Editor에 그대로 복사하면 가장 쉽습니다.
#
# 예시)
# MYSQL_URL="mysql://${MYSQLUSER}:${MYSQL_ROOT_PASSWORD}@${RAILWAY_PRIVATE_DOMAIN}:3306/${MYSQL_DATABASE}"
# MYSQL_ROOT_PASSWORD="pJJh..."
# MYSQL_DATABASE="${MYSQL_DATABASE}"
# MYSQLUSER="root"
#
# 그런 다음 spring.datasource.url 에서 jdbc:mysql:// 형태로 변환해서 사용합니다.
spring.datasource.url=jdbc:${MYSQL_URL}
spring.datasource.username=${MYSQLUSER}
spring.datasource.password=${MYSQL_ROOT_PASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

########################################
# JPA / Hibernate (운영 환경 안전 설정)
########################################
# 운영에서는 자동 스키마 변경 금지 (데이터 손실 방지)
spring.jpa.hibernate.ddl-auto=none
# JPA open-in-view 경고 해결
spring.jpa.open-in-view=false

# SQL 로그 출력 비활성화 (성능 향상)
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

########################################
# Flyway (DB 마이그레이션)
########################################
# 운영 환경에서는 Flyway 활성화 권장
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-version=0
spring.flyway.sql-migration-prefix=V
spring.flyway.sql-migration-separator=__
spring.flyway.sql-migration-suffixes=.sql
spring.flyway.validate-on-migrate=true

########################################
# Thymeleaf (운영 환경 최적화)
########################################
# 운영 환경(JAR)에서는 classpath를 사용해야 함 (file: 경로 사용 불가)
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
# 템플릿 캐시 활성화 (성능 향상)
spring.thymeleaf.cache=true
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.check-template-location=true

########################################
# 정적 리소스 (운영 환경 최적화)
########################################
# 운영 환경(JAR)에서는 classpath를 사용해야 함
spring.web.resources.static-locations=classpath:/static/
spring.web.resources.cache.period=3600
spring.web.resources.chain.cache=true

########################################
# DevTools (운영 환경 비활성화)
########################################
spring.devtools.restart.enabled=false
spring.devtools.livereload.enabled=false

########################################
# 로깅 설정 (운영 환경)
########################################
logging.level.root=INFO
logging.level.com.inet=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN
logging.level.org.springframework.security=WARN

# 로그 파일 설정
logging.file.name=logs/spring.log
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# 로그 파일 롤링 설정 (선택사항)
logging.logback.rollingpolicy.max-history=30
logging.logback.rollingpolicy.max-file-size=10MB

########################################
# 관리자 계정 설정 (환경변수로 설정 가능)
########################################
# Railway 환경 변수에서 설정:
# ADMIN_USERNAME=admin
# ADMIN_PASSWORD=admin123!
